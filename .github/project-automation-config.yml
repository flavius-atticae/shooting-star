# GitHub Project Automation Configuration for Shooting Star
# This file defines the rules and conditions for automated project board transitions

project_config:
  name: "Shooting Star Project"
  columns:
    backlog: "Backlog"
    todo: "À Faire"
    in_progress: "En Cours"
    review: "Review"
    testing: "Testing"
    done: "Done"
    released: "Released"

automation_rules:
  # Backlog → À Faire
  backlog_to_todo:
    triggers:
      - issue_assigned: true
      - label_added: ["ready", "approved", "priority/high", "priority/critical"]
      - milestone_added: true
    conditions:
      - has_assignee: true
      - not_draft: true
    actions:
      - move_to_column: "À Faire"
      - add_comment: "Issue moved to À Faire - ready for development"
      - add_label: "in-queue"

  # À Faire → En Cours
  todo_to_in_progress:
    triggers:
      - branch_created: true  # Branch name contains issue number
      - pull_request_opened: true
      - commit_references_issue: true
    conditions:
      - issue_linked: true
      - has_assignee: true
    actions:
      - move_to_column: "En Cours"
      - add_comment: "Development started"
      - add_label: "in-development"
      - remove_label: "in-queue"

  # En Cours → Review
  in_progress_to_review:
    triggers:
      - pull_request_ready_for_review: true
      - pull_request_draft_to_ready: true
    conditions:
      - pull_request_not_draft: true
      - ci_checks_initiated: true
    actions:
      - move_to_column: "Review"
      - add_comment: "Ready for code review"
      - add_label: "needs-review"
      - remove_label: "in-development"
      - request_reviewers: true

  # Review → Testing
  review_to_testing:
    triggers:
      - pull_request_approved: true
      - all_ci_checks_passed: true
    conditions:
      - min_approvals: 1
      - no_requested_changes: true
      - ci_status: "success"
      - no_merge_conflicts: true
    actions:
      - move_to_column: "Testing"
      - add_comment: "Approved and ready for testing"
      - add_label: "ready-for-testing"
      - remove_label: "needs-review"

  # Testing → Done
  testing_to_done:
    triggers:
      - pull_request_merged: true
      - issue_closed_completed: true
    conditions:
      - pull_request_merged: true
      - deployment_successful: true
    actions:
      - move_to_column: "Done"
      - add_comment: "Implementation completed and deployed"
      - add_label: "completed"
      - remove_label: ["ready-for-testing", "in-testing"]
      - close_issue: true

  # Done → Released
  done_to_released:
    triggers:
      - release_published: true
      - production_deployment: true
    conditions:
      - issue_in_release_notes: true
      - deployment_environment: "production"
    actions:
      - move_to_column: "Released"
      - add_comment: "Feature released to production"
      - add_label: "released"
      - remove_label: "completed"

# Quality Gates Configuration
quality_gates:
  code_quality:
    required_checks:
      - typecheck: true
      - build: true
      - lint: false  # Optional for now
    blocking: true

  security:
    required_checks:
      - security_audit: true
      - sensitive_files_check: true
    blocking: true

  performance:
    required_checks:
      - bundle_size_check: true
      - build_time_check: false
    blocking: false

  accessibility:
    required_checks:
      - axe_core_scan: true
      - keyboard_navigation: false
    blocking: false

# Label Management
labels:
  priority:
    - name: "priority/low"
      color: "0E8A16"
      description: "Low priority issue"
    - name: "priority/medium"
      color: "FBCA04"
      description: "Medium priority issue"
    - name: "priority/high"
      color: "FF9500"
      description: "High priority issue"
    - name: "priority/critical"
      color: "B60205"
      description: "Critical priority issue"

  type:
    - name: "type/bug"
      color: "D73A49"
      description: "Something isn't working"
    - name: "type/feature"
      color: "A2EEEF"
      description: "New feature or request"
    - name: "type/enhancement"
      color: "84B6EB"
      description: "Improvement to existing feature"
    - name: "type/documentation"
      color: "0075CA"
      description: "Improvements or additions to documentation"

  status:
    - name: "status/triage"
      color: "EDEDED"
      description: "Needs initial review and prioritization"
    - name: "status/ready"
      color: "0E8A16"
      description: "Ready for development"
    - name: "status/in-development"
      color: "FBCA04"
      description: "Currently being worked on"
    - name: "status/needs-review"
      color: "FF9500"
      description: "Waiting for code review"
    - name: "status/ready-for-testing"
      color: "1D76DB"
      description: "Ready for testing"
    - name: "status/completed"
      color: "0E8A16"
      description: "Implementation completed"
    - name: "status/released"
      color: "5319E7"
      description: "Released to production"

# Notification Settings
notifications:
  slack:
    enabled: false
    webhook_url: ""
    channels:
      critical_issues: "#alerts"
      deployments: "#deployments"
      releases: "#general"

  email:
    enabled: false
    smtp_settings:
      host: ""
      port: 587
      username: ""
      password: ""

# Automation Exceptions
exceptions:
  skip_automation:
    labels: ["manual-control", "automation-disabled"]
    users: ["dependabot[bot]", "github-actions[bot]"]
    
  emergency_procedures:
    bypass_quality_gates:
      labels: ["hotfix", "emergency"]
      requires_approval_from: ["repository-owner"]
    
    direct_to_production:
      conditions:
        - label: "hotfix"
        - approved_by: "repository-owner"
        - security_cleared: true

# Metrics and Reporting
metrics:
  track:
    - cycle_time: true  # Time from À Faire to Done
    - lead_time: true   # Time from Backlog to Released
    - review_time: true # Time spent in Review
    - deployment_frequency: true
    - failure_rate: true
  
  reports:
    weekly_summary: true
    monthly_analysis: true
    release_notes_auto_generation: true