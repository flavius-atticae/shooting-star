# Development Guide

> Auto-generated by Document Project workflow on 2026-02-13.
> Mode: initial_scan | Scan Level: exhaustive

## Prerequisites

| Requirement | Version           | Notes                                        |
| ----------- | ----------------- | -------------------------------------------- |
| **Node.js** | 22+               | LTS recommended (Dev Container uses Node 22) |
| **npm**     | Bundled with Node | For dependency management                    |
| **Docker**  | Optional          | For Dev Container or production builds       |
| **VS Code** | Latest            | Recommended IDE with Dev Container support   |

## Quick Start

```bash
# Clone the repository
git clone https://github.com/flavius-atticae/shooting-star.git
cd shooting-star

# Install dependencies
npm install

# Start development server (SSR, port 5173)
npm run dev

# In a separate terminal, start Storybook (port 6006)
npm run storybook
```

## Dev Container Setup (Recommended)

The project includes a Dev Container configuration for consistent development environments:

**VS Code + Docker:**

1. Install the "Dev Containers" extension
2. Open the project folder
3. Click "Reopen in Container" when prompted
4. Dependencies and Playwright install automatically via `postCreateCommand`

**GitHub Codespaces:**

1. Navigate to the repository on GitHub
2. Click "Code" → "Codespaces" → "Create codespace on main"
3. Environment is ready automatically

### Dev Container Features

| Feature             | Details                                                                                 |
| ------------------- | --------------------------------------------------------------------------------------- |
| **Base Image**      | `mcr.microsoft.com/devcontainers/javascript-node:22`                                    |
| **GitHub CLI**      | Pre-installed via features                                                              |
| **Forwarded Ports** | 5173 (Vite), 6006 (Storybook)                                                           |
| **Post-create**     | `npm install && npx playwright install --with-deps chromium && npx bmad-method install` |

### Pre-installed VS Code Extensions

| Extension                 | Purpose                     |
| ------------------------- | --------------------------- |
| Tailwind CSS IntelliSense | Tailwind class autocomplete |
| ESLint                    | Code linting                |
| Prettier                  | Code formatting             |
| MDX                       | MDX file support            |
| GitHub Copilot + Chat     | AI assistance               |
| GitHub Actions            | Workflow visualization      |
| GitHub Pull Requests      | PR management               |
| npm Intellisense          | Package autocomplete        |
| Pretty TypeScript Errors  | Better TS error display     |
| Night Owl                 | Color theme                 |
| Codacy                    | Code quality integration    |

## npm Scripts

| Script            | Command                                      | Description                                   |
| ----------------- | -------------------------------------------- | --------------------------------------------- |
| `dev`             | `react-router dev`                           | Start development server with SSR (port 5173) |
| `build`           | `react-router build`                         | Production build                              |
| `start`           | `react-router-serve ./build/server/index.js` | Serve production build                        |
| `typecheck`       | `react-router typegen && tsc`                | Generate types + TypeScript check             |
| `test`            | `vitest run`                                 | Run unit tests (single run)                   |
| `test:watch`      | `vitest`                                     | Run unit tests in watch mode                  |
| `test:ui`         | `vitest --ui`                                | Run tests with Vitest UI                      |
| `test:e2e`        | `playwright test`                            | Run E2E tests                                 |
| `test:e2e:ui`     | `playwright test --ui`                       | Run E2E tests with Playwright UI              |
| `test:e2e:headed` | `playwright test --headed`                   | Run E2E tests in headed browser               |
| `test:e2e:debug`  | `playwright test --debug`                    | Debug E2E tests                               |
| `test:e2e:report` | `playwright show-report`                     | Open E2E test report                          |
| `test:all`        | `npm run test && npm run test:e2e`           | Run all tests                                 |
| `storybook`       | `storybook dev -p 6006 --no-open`            | Start Storybook dev server                    |
| `build-storybook` | `storybook build`                            | Build static Storybook                        |
| `chromatic`       | `chromatic --exit-zero-on-changes`           | Run Chromatic visual regression               |

## Environment Variables

Copy `.env.example` to `.env` and configure:

```bash
# Email (Resend API for contact form)
RESEND_API_KEY=re_your_api_key
RESEND_FROM_EMAIL=contact@yourdomain.com
RESEND_FROM_NAME="Pauline Roussel"
CONTACT_REPLY_TO=pauline@yourdomain.com

# Security
HONEYPOT_ENCRYPTION_SEED=your-random-seed-here
```

| Variable                   | Required   | Default      | Description                             |
| -------------------------- | ---------- | ------------ | --------------------------------------- |
| `RESEND_API_KEY`           | Production | —            | Resend API key for transactional emails |
| `RESEND_FROM_EMAIL`        | Production | —            | Sender email address                    |
| `RESEND_FROM_NAME`         | No         | —            | Sender display name                     |
| `CONTACT_REPLY_TO`         | No         | —            | Reply-to address                        |
| `HONEYPOT_ENCRYPTION_SEED` | Production | Dev fallback | Encryption seed for honeypot fields     |

## Development Workflow

### Git Branching

```
main (protected)
  ├── feature/issue-012-prenatal-yoga-page
  ├── feature/issue-023-postnatal-yoga-page
  └── fix/issue-034-contact-form-validation
```

- **Never** work directly on `main`
- Branch naming: `feature/issue-<number>-<description>` or `fix/issue-<number>-<description>`
- All PRs target `main`

### Commit Messages

```
[ #12 ] Add prenatal yoga page
[ #23 ] Implement postnatal yoga section
[ #34 ] Fix contact form validation
```

### PR Description Structure

1. **Context** — Problem or feature addressed
2. **Main changes** — Bullet list of key changes
3. **Accessibility impact** — WCAG 2.1 AA compliance
4. **Performance impact** — Bundle size, LCP
5. **Compliance impact** — GDPR/PIPEDA/Law 25

## Testing Strategy

### Test Pyramid

```
        ╱╲
       ╱E2E╲          Playwright (5 spec files)
      ╱──────╲         Cross-browser, mobile, a11y, performance
     ╱ Stories ╲       Storybook play functions (18 story files)
    ╱───────────╲      Visual regression, interaction tests
   ╱ Integration ╲    Vitest (4 integration files)
  ╱────────────────╲   Route rendering, navigation
 ╱    Unit Tests    ╲  Vitest (15+ unit files)
╱────────────────────╲ Components, hooks, utilities, server logic
```

### Test Helpers

- **Custom render** — Wraps components with necessary providers (`app/test/utils.tsx`)
- **checkAccessibility()** — jest-axe WCAG AA validation
- **PregnancySafeTestUtils** — Touch target (44px+), color safety, motion checks
- **Pregnancy personas** — Marie (3rd trimester), Sophie (morning sickness), Alexandra (postpartum)

### Running Tests

```bash
# Unit & Component tests (Vitest with browser mode)
npm run test

# Watch mode during development
npm run test:watch

# E2E tests (requires dev server running)
npm run dev  # Terminal 1
npm run test:e2e  # Terminal 2

# All tests
npm run test:all
```

## Code Quality

### TypeScript

- **Strict mode** enabled (`tsconfig.json`)
- Path aliases: `~/` maps to `./app/`
- Auto-generated route types via `react-router typegen`

### Formatting

- **Prettier** — Auto-format on save (configured in Dev Container)
- **Tab size**: 2 spaces
- **Editor**: Format on save enabled

### Code Analysis

- **Codacy** — Automated analysis via MCP server
- **ESLint** — Configuration via `.codacy/tools-configs/eslint.config.mjs`
- **Trivy** — Security vulnerability scanning

## File Organization Patterns

### Component Module Structure

```
component-name/
├── component-name.tsx        # Main component
├── sub-component.tsx         # Sub-components (if any)
├── component-name.stories.tsx # Storybook stories
├── design-rationale.stories.mdx # Design docs (optional)
└── index.ts                  # Barrel export
```

### Import Order Convention

1. React / framework imports
2. Third-party library imports
3. Internal absolute imports (`~/...`)
4. Relative imports (`./...`)

### Naming Conventions

| Type             | Convention                  | Example                                   |
| ---------------- | --------------------------- | ----------------------------------------- |
| Components       | PascalCase                  | `ContactForm`, `HeroContent`              |
| Files            | kebab-case                  | `contact-form.tsx`, `hero-animations.tsx` |
| Props interfaces | PascalCase + `Props`        | `ContactFormProps`, `HeroProps`           |
| Hooks            | camelCase with `use` prefix | `useMotionPreferences`                    |
| Data files       | kebab-case                  | `call-to-action.ts`                       |
| Server modules   | `.server.ts` suffix         | `email.server.ts`                         |
| Test files       | `.test.ts(x)` suffix        | `contact-form.test.tsx`                   |
| Story files      | `.stories.tsx` suffix       | `contact-form.stories.tsx`                |
| E2E specs        | `.spec.ts` suffix           | `homepage.spec.ts`                        |
